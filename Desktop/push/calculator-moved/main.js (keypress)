// esc = clear.    = = calcuate.      I tried getting the numbers, but I'm having a hard time with it. I think I'm just messing up
//with what input goes where. Operators 

function reset(equation) { //sets calculator to base-state: 0, no functions active, etc.
    $("#textbox").val(equation);
    $(".fun").removeClass("activeFunction");
    $("#textbox").data("functionisActive", false);
    $("#textbox").data("theactiveFunction", "");
    $("#textbox").data("firstHeld", false);
    $("#textbox").data("secondHeld", false);
    $("#textbox").data("first", equation);
    $("#textbox").data("second", 0);
    $("#textbox").data("previous", false);
}

$(document).ready(function() {
  reset(0); //starts everything off at 0.
  $(document).on('keyup', function() {
    if ($("#textbox").data("previous") === true) { //if textbox isn't empty, clear it, and start fresh.
        reset($(this).text());
    }
    else if (($("#textbox").data("functionisActive") === true) &&
             ($("#textbox").data("firstHeld") === false)) {
      $("#textbox").data("first", $("#textbox").val());
      $("#textbox").data("firstHeld", true); //locks the first number in place to store it for now
      $("#textbox").val($(this).text());
      $("#textbox").data("second", $("#textbox").val());
      $("#textbox").data("secondHeld", true);
    }
    else if (($("#textbox").data("functionisActive") === true) &&
             ($("#textbox").data("firstHeld") === true)) {
      var equation = $("#textbox").val();
      var newStuff = $(this).text();
      var newValue = equation + newStuff;
      $("#textbox").val(newValue);
      $("#textbox").data("second", $("#textbox").val());
      $("#textbox").data("secondHeld", true);
    }
    else {
      if (e.which===48) {
        $("#textbox").val('0');
      }
      if (e.which===49) {
        $("#textbox").val('1');
      }
      if (e.which===50) {
        $("#textbox").val('2');
      }
      if (e.which===51) {
        $("#textbox").val('3');
      }
      if (e.which===52) {
        $("#textbox").val('4');
      }
      if (e.which===53) {
        $("#textbox").val('5');
      }
      if (e.which===54) {
        $("#textbox").val('6');
      }
      if (e.which===55) {
        $("#textbox").val('7');
      }
      if (e.which===56) {
        $("#textbox").val('8');
      }
      if (e.which===56) {
        $("#textbox").val('9');
      }
      if (equation === "0") {
        equation = "";
      }
      var newStuff = $(this).text();
      var newValue = equation + newStuff;
      $("#textbox").val(newValue);
    };
  });
  $(".fun").on('click', function() {
    if ($("#textbox").data("previous") === true) {
      reset($("#textbox").val());     //taking everything back
      $("#textbox").data("firstHeld", false);
      $("#textbox").data("previous", false)
    }
    var activeFunction = $(this).text();
    $("#textbox").data("functionisActive", true);
    $("#textbox").data("theactiveFunction", activeFunction);
    $(".fun").removeClass("activeFunction");
    $(this).addClass("activeFunction");
  });
  $(document).on('keydown', function(e) {
    if(e.which == 187) {
      result = 0;
      if (($("#textbox").data("firstHeld") === true) &&
         ($("#textbox").data("secondHeld") === true)) {

        if ($("#textbox").data("theactiveFunction") === '+') {
          result += (parseFloat($("#textbox").data("first")) +
          parseFloat($("#textbox").data("second")));
        }
        else if ($("#textbox").data("theactiveFunction") === '-') {
          result += (parseFloat($("#textbox").data("first")) -
          parseFloat($("#textbox").data("second")));
        }
        else if ($("#textbox").data("theactiveFunction") === '*') {
          result += parseFloat($("#textbox").data("first")) *
                    parseFloat($("#textbox").data("second"));
        }
        else if ($("#textbox").data("theactiveFunction") === '/') {
          result += parseFloat($("#textbox").data("first")) /
          parseFloat($("#textbox").data("second"));
        }
        else if ($("#textbox").data("theactiveFunction") === '**') {
          result += Math.pow(parseFloat($("#textbox").data("first")),
          parseFloat($("#textbox").data("second")));
        }
        else if ($("#textbox").data("theactiveFunction") === "\u221a") {
          result += Math.pow(parseFloat($("#textbox").data("first")),
          1/parseFloat($("#textbox").data("second")));
        }
        $("#textbox").val(result);
        reset(result);
        $("#textbox").data("previous", true);
       }
       else {
       }
     }
    });
   $(document).on('keyup', function(e){
     if(e.which === 27) {
       reset("0");
     }
  });
});
